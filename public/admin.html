<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SHOGUN | Mando Central</title>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@500;700;900&family=Rajdhani:wght@400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <link rel="stylesheet" href="css/main.css">
    
    <style>
        :root {
            --bg-dark: #050505;
            --panel-bg: #0a0a0a;
            --border: #222;
            --gold: #ffb400;
            --blood: #d90429;
            --text-muted: #666;
        }

        /* RESETEO VITAL PARA EVITAR BORDES BLANCOS */
        body {
            background-color: var(--bg-dark);
            color: #e0e0e0;
            margin: 0; 
            padding: 0;
            height: 100vh;
            overflow: hidden;
            font-family: 'Rajdhani', sans-serif;
            display: flex;
        }

        /* --- SIDEBAR (IZQUIERDA) --- */
        .sidebar {
            width: 260px;
            background: #050505; /* Fondo sólido para evitar cortes */
            border-right: 1px solid var(--border);
            display: flex;
            flex-direction: column;
            padding: 30px 20px; /* Espaciado uniforme */
            z-index: 100;
            flex-shrink: 0;
        }

        .brand {
            margin-bottom: 30px;
            padding-left: 10px;
            text-align: left;
            /* Sin bordes ni fondos raros */
        }
        
        .brand h1 { 
            margin: 0; 
            font-family: 'Orbitron'; 
            font-size: 1.6rem; 
            letter-spacing: 2px; 
            color: #fff; 
            text-shadow: 0 0 15px rgba(217, 4, 41, 0.4);
        }
        
        .brand span { 
            color: var(--blood); 
            font-size: 0.8rem; 
            letter-spacing: 3px;
            display: block;
            margin-top: 5px;
            opacity: 0.8;
        }

        .menu-btn {
            background: transparent; border: none; color: #888;
            width: 100%; padding: 14px 15px; text-align: left;
            font-family: 'Orbitron'; font-size: 0.85rem; cursor: pointer;
            transition: 0.2s; border-radius: 6px; margin-bottom: 5px;
            display: flex; align-items: center; gap: 12px;
        }
        
        .menu-btn:hover {
            color: #fff;
            background: rgba(255,255,255,0.05);
        }
        
        .menu-btn.active {
            background: linear-gradient(90deg, rgba(255, 180, 0, 0.1) 0%, transparent 100%);
            color: var(--gold);
            border-left: 3px solid var(--gold);
        }
        
        .badge { background: var(--blood); color: #fff; font-size: 0.7rem; padding: 2px 6px; border-radius: 4px; margin-left: auto; }

        /* --- MAIN CONTENT (DERECHA) --- */
        .main-content {
            flex: 1;
            padding: 30px;
            overflow-y: auto;
            background-image: radial-gradient(circle at top right, #111 0%, #050505 100%);
            position: relative;
        }

        .dashboard-container {
            max-width: 1400px;
            margin: 0 auto;
            animation: fadeIn 0.5s ease-out;
        }

        /* --- TARJETAS DE ESTADÍSTICAS (KPIs) --- */
        .kpi-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .kpi-card {
            background: rgba(20, 20, 20, 0.6);
            backdrop-filter: blur(10px);
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 25px;
            position: relative;
            overflow: hidden;
            transition: transform 0.2s;
        }
        .kpi-card:hover { transform: translateY(-3px); border-color: #333; }
        .kpi-card::before {
            content: ''; position: absolute; top: 0; left: 0; width: 4px; height: 100%;
            background: var(--border);
        }
        .kpi-card.gold::before { background: var(--gold); }
        .kpi-card.red::before { background: var(--blood); }
        .kpi-card.blue::before { background: #3a86ff; }
        
        .kpi-title { font-family: 'Orbitron'; font-size: 0.8rem; color: #888; text-transform: uppercase; letter-spacing: 1px; }
        .kpi-value { font-size: 2.2rem; font-weight: 700; color: #fff; margin: 10px 0; }
        .kpi-sub { font-size: 0.9rem; color: #555; }

        /* --- PANELES Y GRILLAS --- */
        .dashboard-split {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .panel {
            background: #0e0e0e;
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 25px;
            margin-bottom: 20px; /* Espacio si se apilan */
        }
        .panel-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; }
        .panel-title { font-family: 'Orbitron'; color: var(--gold); margin: 0; font-size: 1.1rem; }

        /* --- FORMULARIOS --- */
        .input-pro {
            background: #050505; border: 1px solid #333; color: white;
            padding: 12px; width: 100%; border-radius: 6px; margin-bottom: 15px;
            font-family: 'Rajdhani'; font-size: 1rem; box-sizing: border-box; /* Importante */
        }
        .input-pro:focus { border-color: var(--gold); outline: none; }

        .btn-full { width: 100%; padding: 12px; margin-top: 5px; }

        /* --- TABLAS --- */
        table { width: 100%; border-collapse: collapse; }
        th { text-align: left; color: #666; padding: 15px; border-bottom: 1px solid #222; font-family: 'Orbitron'; font-size: 0.75rem; }
        td { padding: 15px; border-bottom: 1px solid #1a1a1a; color: #ccc; }
        tr:hover td { background: rgba(255,255,255,0.02); }

        /* --- UTILIDADES --- */
        .view-section { display: none; }
        .view-section.active { display: block; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        
        .status-pill { padding: 4px 10px; border-radius: 20px; font-size: 0.75rem; font-weight: bold; }
        .status-pending { background: rgba(255, 180, 0, 0.2); color: var(--gold); }
        .status-ok { background: rgba(16, 185, 129, 0.2); color: #10b981; }

    </style>
</head>
<body>

    <aside class="sidebar">
        <div class="brand">
            <h1>SHOGUN</h1>
            <span>SYSTEM V.1</span>
        </div>
        
        <nav>
            <button class="menu-btn active" onclick="switchView('dashboard', this)">
                <i class="fas fa-chart-pie" style="width:20px; text-align:center;"></i> DASHBOARD
            </button>
            <button class="menu-btn" onclick="switchView('command', this)">
                <i class="fas fa-terminal" style="width:20px; text-align:center;"></i> CENTRO DE MANDO
            </button>
            <button class="menu-btn" onclick="switchView('treasury', this)">
                <i class="fas fa-coins" style="width:20px; text-align:center;"></i> TESORERÍA 
                <span id="treasuryBadge" class="badge" style="display:none">0</span>
            </button>
            <button class="menu-btn" onclick="switchView('users', this)">
                <i class="fas fa-users" style="width:20px; text-align:center;"></i> GUERREROS
            </button>
        </nav>

        <div style="margin-top: auto; border-top: 1px solid #111; padding-top: 20px;">
            <button onclick="window.location.href='dashboard.html'" class="menu-btn" style="border:1px solid #333; justify-content:center; color:#666;">
                <i class="fas fa-sign-out-alt"></i> SALIR AL DOJO
            </button>
        </div>
    </aside>

    <main class="main-content">
        <div class="dashboard-container">

            <div id="view-dashboard" class="view-section active">
                
                <div class="kpi-grid">
                    <div class="kpi-card gold">
                        <div class="kpi-title">FONDO DE LA CASA (DAO)</div>
                        <div id="statProfit" class="kpi-value">$0.00</div>
                        <div class="kpi-sub"><i class="fas fa-arrow-up" style="color:#10b981"></i> Acumulado total</div>
                    </div>
                    <div class="kpi-card blue">
                        <div class="kpi-title">VOLUMEN EN JUEGO</div>
                        <div id="statVol" class="kpi-value">$0.00</div>
                        <div class="kpi-sub">Circulante en ciclos y torneos</div>
                    </div>
                    <div class="kpi-card">
                        <div class="kpi-title">GUERREROS ACTIVOS</div>
                        <div id="statUsers" class="kpi-value">0</div>
                        <div class="kpi-sub">Usuarios registrados</div>
                    </div>
                    <div class="kpi-card red">
                        <div class="kpi-title">PENDIENTES</div>
                        <div id="statPending" class="kpi-value">0</div>
                        <div class="kpi-sub">Solicitudes requieren acción</div>
                    </div>
                </div>

                <div class="dashboard-split">
                    <div class="panel">
                        <div class="panel-header">
                            <h3 class="panel-title">RENDIMIENTO FINANCIERO</h3>
                            <select style="background:#222; border:none; color:#888; padding:5px;"><option>Últimos 7 días</option></select>
                        </div>
                        <div style="height: 300px; width: 100%;">
                            <canvas id="financeChart"></canvas>
                        </div>
                    </div>
                    <div class="panel">
                        <div class="panel-header">
                            <h3 class="panel-title">ÚLTIMOS MOVIMIENTOS</h3>
                        </div>
                        <div id="recentActivity" style="font-size:0.9rem; color:#aaa;">
                            <p style="padding:10px; border-bottom:1px solid #222;">Sistema iniciado correctamente.</p>
                            <p style="padding:10px;">Esperando transacciones...</p>
                        </div>
                    </div>
                </div>
            </div>

            <div id="view-command" class="view-section">
                <h2 style="color:var(--gold); font-family:'Orbitron'; margin-bottom:20px;">OPERACIONES TÁCTICAS</h2>
                
                <div class="dashboard-split">
                    <div class="panel">
                        <div class="panel-header">
                            <h3 class="panel-title"><i class="fas fa-trophy"></i> FORJAR TORNEO</h3>
                        </div>
                        <input type="text" id="tName" placeholder="Nombre del Torneo" class="input-pro">
                        <div style="display:grid; grid-template-columns: 1fr 1fr; gap:10px;">
                            <input type="number" id="tFee" placeholder="Entrada (Fichas)" class="input-pro">
                            <input type="number" id="tPrize" placeholder="Premio ($)" class="input-pro">
                        </div>
                        <button onclick="createTournament()" class="btn-ninja-primary btn-full">CREAR EVENTO</button>
                    </div>

                    <div class="panel">
                        <div class="panel-header">
                            <h3 class="panel-title"><i class="fas fa-gamepad"></i> NUEVO JUEGO</h3>
                        </div>
                        <input type="text" id="gTitle" placeholder="Título" class="input-pro">
                        <input type="text" id="gUrl" placeholder="URL Embed" class="input-pro">
                        <input type="text" id="gThumb" placeholder="URL Thumbnail" class="input-pro">
                        <button onclick="createGame()" class="btn-ninja-outline btn-full">DESPLEGAR</button>
                    </div>
                </div>

                <div class="dashboard-split">
                    <div class="panel">
                        <h4 style="color:#666; margin-top:0;">TORNEOS ACTIVOS</h4>
                        <div id="adminTournaments" style="max-height:200px; overflow-y:auto;">Loading...</div>
                    </div>
                    <div class="panel">
                        <h4 style="color:#666; margin-top:0;">INVENTARIO DE JUEGOS</h4>
                        <div id="adminGames" style="max-height:200px; overflow-y:auto;">Loading...</div>
                    </div>
                </div>
            </div>

            <div id="view-treasury" class="view-section">
                <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:20px;">
                    <h2 style="color:var(--gold); font-family:'Orbitron';">BÓVEDA DEL CLAN</h2>
                    <button onclick="loadPendingDeposits()" class="btn-ninja-outline">ACTUALIZAR DATOS</button>
                </div>

                <div class="panel">
                    <div class="table-container">
                        <table class="treasury-table">
                            <thead>
                                <tr>
                                    <th>FECHA</th>
                                    <th>USUARIO</th>
                                    <th>TIPO</th>
                                    <th>MONTO</th>
                                    <th>DETALLE</th>
                                    <th>ESTADO</th>
                                    <th>ACCIÓN</th>
                                </tr>
                            </thead>
                            <tbody id="depositList">
                                </tbody>
                        </table>
                    </div>
                    <div id="emptyTreasury" style="text-align:center; padding:40px; color:#444; display:none;">
                        <i class="fas fa-check-circle" style="font-size:2rem; margin-bottom:10px;"></i>
                        <p>Sin solicitudes pendientes.</p>
                    </div>
                </div>
            </div>

            <div id="view-users" class="view-section">
                <h2 style="color:var(--gold); font-family:'Orbitron';">CENSO DE GUERREROS</h2>
                <div class="panel">
                    <div id="usersListContainer" style="color:#666; text-align:center; padding:40px;">
                        Cargando base de datos...
                    </div>
                </div>
            </div>

        </div>
    </main>

    <script type="module" src="js/admin.js"></script>
</body>
</html>
